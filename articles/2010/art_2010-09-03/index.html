<!DOCTYPE html><html lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=description content="Site indépendant de veille sur la géomatique libre et open source. Articles, tutoriels et revues de presse (#GeoRDP) sur l'information géographique, les SIG, la cartographie, la représentation des données..."><meta name=author content=Geotribu><link href=https://static.geotribu.fr/articles/2010/art_2010-09-03/ rel=canonical><link rel="shortcut icon" href=../../../img/favicon.ico><title>Créer et diffuser des services WMS avec Qgis - Geotribu</title><link href=../../../css/bootstrap.min.css rel=stylesheet><link href=../../../css/font-awesome.min.css rel=stylesheet><link href=../../../css/bootstrap-theme.min.css rel=stylesheet><link href=../../../../../../theme/assets/stylesheets/extra.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/wa-mediabox@1.0.1/dist/wa-mediabox.min.css rel=stylesheet><!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.3/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]--><script src=../../../js/jquery-1.10.2.min.js></script><script src=../../../js/bootstrap.min.js></script><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'None', 'auto');
            ga('send', 'pageview');
        </script></head> <body> <div class="navbar navbar-default navbar-fixed-top" role=navigation> <div class=container> <div class=navbar-header> <button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-collapse> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href=../../..>Geotribu</a> </div> <div class="navbar-collapse collapse"> <ul class="nav navbar-nav"> <li> <a href=../../..>&#127968; Accueil</a> </li> <li class=dropdown> <a href=# class=dropdown-toggle data-toggle=dropdown>Revues de presse <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../..>2021</a> </li> <li> <a href=../../..>2020</a> </li> <li> <a href=../../..>2017</a> </li> <li> <a href=../../..>2016</a> </li> <li> <a href=../../..>2015</a> </li> <li> <a href=../../..>2014</a> </li> <li> <a href=../../..>2013</a> </li> <li> <a href=../../..>2012</a> </li> <li> <a href=../../..>2011</a> </li> <li> <a href=../../..>2010</a> </li> </ul> </li> <li class="dropdown active"> <a href=# class=dropdown-toggle data-toggle=dropdown>Articles <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../..>2021</a> </li> <li> <a href=../../..>2020</a> </li> <li> <a href=../../..>2015</a> </li> <li> <a href=../../..>2014</a> </li> <li> <a href=../../..>2013</a> </li> <li> <a href=../../..>2012</a> </li> <li> <a href=../../..>2011</a> </li> <li class=active> <a href=../../..>2010</a> </li> <li> <a href=../../..>2009</a> </li> <li> <a href=../../..>2008</a> </li> </ul> </li> <li class=dropdown> <a href=# class=dropdown-toggle data-toggle=dropdown>Contribuer <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../contribuer/introduction/ >Contribuer à Geotribu</a> </li> <li> <a href=../../../contribuer/requirements/ >Prérequis pour la contribution</a> </li> <li> <a href=../../../contribuer/contribution_guide/ >Guide de contribution</a> </li> <li> <a href=../../..>Editer le contenu</a> </li> <li> <a href=../../..>Générer le site web</a> </li> <li> <a href=../../..>Guides de rédaction</a> </li> <li> <a href=../../..>Archives</a> </li> </ul> </li> <li class=dropdown> <a href=# class=dropdown-toggle data-toggle=dropdown>A propos <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../team/ >L'équipe Geotribu</a> </li> <li> <a href=../../../team/acha/ >Aurélien Chaumet</a> </li> <li> <a href=../../../team/avdc/ >Arnaud Vandecasteele</a> </li> <li> <a href=../../../team/avha/ >Adrien Van Hamme</a> </li> <li> <a href=../../../team/edel/ >Etienne Delay</a> </li> <li> <a href=../../../team/fbor/ >Florian Boret</a> </li> <li> <a href=../../../team/fgob/ >Fabien Goblet</a> </li> <li> <a href=../../../team/gdbo/ >Guillaume de Boyer</a> </li> <li> <a href=../../../team/jmou/ >Julien Moura</a> </li> <li> <a href=../../../team/jory/ >Jérémie Ory</a> </li> <li> <a href=../../../team/jpie/ >Julie Pierson</a> </li> <li> <a href=../../../team/mraj/ >Mathieu Rajerison</a> </li> <li> <a href=../../../team/pver/ >Pierre Vernier</a> </li> <li> <a href=../../../team/rbov/ >Rémi Bovard</a> </li> <li> <a href=../../../team/rqui/ >Rodolphe Quiédeville</a> </li> <li> <a href=../../../team/tgra/ >Thomas Gratier</a> </li> <li> <a href=../../..>Archives</a> </li> </ul> </li> </ul> <ul class="nav navbar-nav navbar-right"> <li> <a href=../art_2010-09-23/ rel=next> <i class="fa fa-arrow-left"></i> Previous </a> </li> <li> <a href=../art_2010-08-25/ rel=prev> Next <i class="fa fa-arrow-right"></i> </a> </li> <li> <a href=https://github.com/geotribu/website/ > geotribu/website </a> </li> </ul> </div> </div> </div> <div class=container> <div class=row> <div class=col-md-3><div class="bs-sidebar hidden-print affix well" role=complementary> <ul class="nav bs-sidenav"> <li class="main active"><a href=#creer-et-diffuser-des-services-wms-avec-qgis>Créer et diffuser des services WMS avec Qgis</a></li> <li><a href=#installation-et-parametrages>Installation et paramétrages</a></li> <li><a href=#creation-du-projet-qgis>Création du projet QGIS</a></li> <li><a href=#creation-du-service-wms>Création du service WMS</a></li> <li><a href=#auteur>Auteur</a></li> </ul> </div></div> <div class=col-md-9 role=main> <h1 id=creer-et-diffuser-des-services-wms-avec-qgis>Créer et diffuser des services WMS avec Qgis<a class=headerlink href=#creer-et-diffuser-des-services-wms-avec-qgis title="Permanent link">#</a></h1> <p>:calendar: Date de publication initiale : 03 septembre 2010</p> <p><strong>Mots-clés :</strong> WMS | Open Source | QGIS</p> <p><a href=https://www.qgis.org/ >QGIS</a> est l'un voir même, à mon sens, le meilleur logiciel SIG OpenSource existant actuellement. Ses possibilités ainsi que les plugins dont il dispose font qu'il offre toutes les fonctionnalités dont a besoin un géomaticien pour son travail quotidien. La dernière nouveauté que j'ai pu découvrir, grâce au blog <a href=http://linfiniti.com/2010/08/qgis-mapserver-a-wms-server-for-the-masses/ >linfiniti</a>, est la possibilité de créer et de publier des services WMS directement depuis QGIS. Cette fonctionnalité a été développée par l'<a href=http://www.karto.ethz.ch/ >institut cartographique de Zurich</a> dans le cadre du projet <a href=http://www.eu-orchestra.org/ >orchestra</a>. Vous pourrez ainsi, directement depuis votre logiciel SIG, définir le style de vos couches avant de les exporter sur Internet.</p> <hr> <h3 id=installation-et-parametrages>Installation et paramétrages<a class=headerlink href=#installation-et-parametrages title="Permanent link">#</a></h3> <p>La communication entre QGIS Mapserver et notre serveur Web s'appuie sur le protocole CGI/FCGI. Commençons alors par l'installer :</p> <p>sudo apt-get install libfcgi-dev Attaquons-nous maintenant à l'installation de QGIS Mapserver. Deux solutions s'offrent alors à vous : la compilation ou l'utilisation du dépôt <a href=https://launchpad.net/~ubuntugis/+archive/ubuntugis-unstable>ubuntugis</a>. Pour ma part, j'ai opté pour la solution numéro deux, bien plus facile et surtout beaucoup plus sûre.</p> <p>sudo apt-get install qgis-mapserver Une fois le téléchargement et l'installation terminés, vous trouverez, dans le répertoire /usr/lib/cgi-bin/, le fichier qgis_mapserv.fcgi. C'est ce dernier qui va interpréter les requêtes WMS et les retourner ensuite sous forme d'images.</p> <p>Contrairement aux instructions données sur le blog <a href=http://linfiniti.com/2010/08/qgis-mapserver-a-wms-server-for-the-masses/ >linfiniti</a>, je n'ai pas eu besoin de spécifier à mon serveur où se trouve le fichier qgis_mapserv.fcgi. En effet, ayant effectuée une installation classique, celui-ci a été automatiquement placé dans mon répertoire cgi.</p> <h3 id=creation-du-projet-qgis>Création du projet QGIS<a class=headerlink href=#creation-du-projet-qgis title="Permanent link">#</a></h3> <p>Alors là rien de plus simple ! Démarrez tout simplement QGIS et créez un projet quelconque. Afin de vous montrer toute l'étendue de cette nouvelle fonctionnalité, j'ai effectué une analyse thématique. Vous verrez qu'au moment de la création du service WMS, le style que nous avons spécifié sera préservé.</p> <h3 id=creation-du-service-wms>Création du service WMS<a class=headerlink href=#creation-du-service-wms title="Permanent link">#</a></h3> <p>Allez, dernière ligne droite. Commençons par créer un nouveau dossier dans notre répertoire cgi-bin. La règle pour QGIS MapServer est : <strong>un projet égal un dossier</strong>. Nous appellerons le nôtre "world-analyse". Maintenant, il reste à créer trois liens symboliques. Le premier pointant vers script qgis_mapserv.fcgi, le second vers votre projet QGIS et enfin le dernier vers le fichier wms_metadata.xml. Vous pourrez personnaliser ce dernier fichier en y ajoutant les différentes informations concernant le producteur de la donnée (nom de l'organisme, nom du référent...).</p> <p>/usr/lib/cgi-bin/world-analyse$ sudo ln -s /home/arnaud/GisData/world_analyse.qgs . /usr/lib/cgi-bin/world-analyse$ sudo ln -s ../qgis_mapserv.fcgi .<br> /usr/lib/cgi-bin/world-analyse$ sudo ln -s ../wms_metadata.xml . ### Test du service WMS</p> <p>Et voilà tout est maintenant en place. Interrogeons maintenant notre serveur et ce qu'il est capable de faire :</p> <p>http://localhost/cgi-bin/world-analyse/qgis_mapserv.fcgi?SERVICE=WMS&amp;VERSION=1.3.0&amp;REQUEST=GetCapabilities Une rapide vérification du fichier XML généré m'apprend que ma couche est bien présente :</p> <p>TM_WORLD_BORDERS-0.3TM_WORLD_BORDERS-0.3 EPSG:102067 EPSG:2000 EPSG:93023 EPSG:93024 <ex\_geographicboundingbox> -180 180 -90 83.6236 Muni de ces informations, je peux maintenant effectuer ma requête WMS GetMap afin de visualiser l'image retournée sur mon navigateur :</p> <p>http://localhost/cgi-bin/world-analyse/qgis_mapserv.fcgi?SERVICE=WMS&amp;VERSION=1.3.0&amp;REQUEST=GetMap &amp;BBOX=100,-180,-90,100&amp;CRS=EPSG:4326&amp;WIDTH=800&amp;HEIGHT=400&amp;LAYERS=TM_WORLD_BORDERS-0.3 &amp;STYLES=,,&amp;FORMAT=image/jpeg&amp;DPI=96 Et, tada ! Voilà le résultat : Comme vous pouvez le constater, une fois la procédure connue, cela ne prend pas plus de 2 minutes à créer et diffuser un nouveau service WMS. De plus, le fait de pouvoir définir le style des couches directement depuis QGIS apporte une réelle souplesse d'utilisation. Néanmoins, il reste à connaitre maintenant les performances de ce serveur cartographique. Le <a href=http://blog.opengeo.org/2010/08/16/wms-benchmarking/ >benchmark</a> organisé lors du prochain <a href=http://2010.foss4g.org/ >FOSS4G</a> devrait très certainement nous apporter des informations intéressantes.</p> <hr> <h2 id=auteur>Auteur<a class=headerlink href=#auteur title="Permanent link">#</a></h2> <p><img alt="Portait de GeoTribu" class=img-rdp-news-thumb src=https://cdn.geotribu.fr/img/internal/charte/geotribu_logo_64x64.png> <strong>GeoTribu</strong></p> <p>Toute l'actualité de la géomatique Open Source ! Mais aussi des tutoriels, des billets de blog, des tests et surtout une bonne humeur géographique !</p></div> </div> </div> <hr> <footer class=container> <center><span class=copyleft>&copy;</span> Geotribu</center> <center>Documentation built with <a href=http://www.mkdocs.org>MkDocs</a> and <a href=http://kristopolous.github.io/BOOTSTRA.386>BOOTSTRA.386</a>.</center> </footer> <script src=../../../../../../theme/assets/javascripts/extra.js></script> <script src=https://cdn.jsdelivr.net/npm/wa-mediabox@1.0.1/dist/wa-mediabox.min.js></script> <script src=https://unpkg.com/mermaid@8.6.4/dist/mermaid.min.js></script> <script src=../../../../../../search/main.js></script> </body> </html>