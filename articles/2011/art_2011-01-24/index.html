<!DOCTYPE html><html lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=description content="Site indépendant de veille sur la géomatique libre et open source. Articles, tutoriels et revues de presse (#GeoRDP) sur l'information géographique, les SIG, la cartographie, la représentation des données..."><meta name=author content=Geotribu><link href=https://static.geotribu.fr/articles/2011/art_2011-01-24/ rel=canonical><link rel="shortcut icon" href=../../../img/favicon.ico><title>PolyMaps une alternative à OpenLayers - Geotribu</title><link href=../../../css/bootstrap.min.css rel=stylesheet><link href=../../../css/font-awesome.min.css rel=stylesheet><link href=../../../css/bootstrap-theme.min.css rel=stylesheet><link href=../../../../../../theme/assets/stylesheets/extra.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/wa-mediabox@1.0.1/dist/wa-mediabox.min.css rel=stylesheet><!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.3/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]--><script src=../../../js/jquery-1.10.2.min.js></script><script src=../../../js/bootstrap.min.js></script><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'None', 'auto');
            ga('send', 'pageview');
        </script></head> <body> <div class="navbar navbar-default navbar-fixed-top" role=navigation> <div class=container> <div class=navbar-header> <button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-collapse> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href=../../..>Geotribu</a> </div> <div class="navbar-collapse collapse"> <ul class="nav navbar-nav"> <li> <a href=../../..>&#127968; Accueil</a> </li> <li class=dropdown> <a href=# class=dropdown-toggle data-toggle=dropdown>Revues de presse <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../..>2021</a> </li> <li> <a href=../../..>2020</a> </li> <li> <a href=../../..>2017</a> </li> <li> <a href=../../..>2016</a> </li> <li> <a href=../../..>2015</a> </li> <li> <a href=../../..>2014</a> </li> <li> <a href=../../..>2013</a> </li> <li> <a href=../../..>2012</a> </li> <li> <a href=../../..>2011</a> </li> <li> <a href=../../..>2010</a> </li> </ul> </li> <li class="dropdown active"> <a href=# class=dropdown-toggle data-toggle=dropdown>Articles <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../..>2021</a> </li> <li> <a href=../../..>2020</a> </li> <li> <a href=../../..>2015</a> </li> <li> <a href=../../..>2014</a> </li> <li> <a href=../../..>2013</a> </li> <li> <a href=../../..>2012</a> </li> <li class=active> <a href=../../..>2011</a> </li> <li> <a href=../../..>2010</a> </li> <li> <a href=../../..>2009</a> </li> <li> <a href=../../..>2008</a> </li> </ul> </li> <li class=dropdown> <a href=# class=dropdown-toggle data-toggle=dropdown>Contribuer <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../contribuer/introduction/ >Contribuer à Geotribu</a> </li> <li> <a href=../../../contribuer/requirements/ >Prérequis pour la contribution</a> </li> <li> <a href=../../../contribuer/contribution_guide/ >Guide de contribution</a> </li> <li> <a href=../../..>Editer le contenu</a> </li> <li> <a href=../../..>Générer le site web</a> </li> <li> <a href=../../..>Guides de rédaction</a> </li> <li> <a href=../../..>Archives</a> </li> </ul> </li> <li class=dropdown> <a href=# class=dropdown-toggle data-toggle=dropdown>A propos <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../team/ >L'équipe Geotribu</a> </li> <li> <a href=../../../team/acha/ >Aurélien Chaumet</a> </li> <li> <a href=../../../team/avdc/ >Arnaud Vandecasteele</a> </li> <li> <a href=../../../team/avha/ >Adrien Van Hamme</a> </li> <li> <a href=../../../team/edel/ >Etienne Delay</a> </li> <li> <a href=../../../team/fbor/ >Florian Boret</a> </li> <li> <a href=../../../team/fgob/ >Fabien Goblet</a> </li> <li> <a href=../../../team/gdbo/ >Guillaume de Boyer</a> </li> <li> <a href=../../../team/jmou/ >Julien Moura</a> </li> <li> <a href=../../../team/jory/ >Jérémie Ory</a> </li> <li> <a href=../../../team/jpie/ >Julie Pierson</a> </li> <li> <a href=../../../team/mraj/ >Mathieu Rajerison</a> </li> <li> <a href=../../../team/pver/ >Pierre Vernier</a> </li> <li> <a href=../../../team/rbov/ >Rémi Bovard</a> </li> <li> <a href=../../../team/rqui/ >Rodolphe Quiédeville</a> </li> <li> <a href=../../../team/tgra/ >Thomas Gratier</a> </li> <li> <a href=../../..>Archives</a> </li> </ul> </li> </ul> <ul class="nav navbar-nav navbar-right"> <li> <a href=../art_2011-02-09/ rel=next> <i class="fa fa-arrow-left"></i> Previous </a> </li> <li> <a href=../art_2011-01-19/ rel=prev> Next <i class="fa fa-arrow-right"></i> </a> </li> <li> <a href=https://github.com/geotribu/website/ > geotribu/website </a> </li> </ul> </div> </div> </div> <div class=container> <div class=row> <div class=col-md-3><div class="bs-sidebar hidden-print affix well" role=complementary> <ul class="nav bs-sidenav"> <li class="main active"><a href=#polymaps-une-alternative-a-openlayers>PolyMaps une alternative à OpenLayers</a></li> <li><a href=#telechargement>Téléchargement</a></li> <li><a href=#initialisation>Initialisation</a></li> <li><a href=#javascript>JavaScript</a></li> <li><a href=#premiere-conclusion>Première conclusion</a></li> <li><a href=#auteur>Auteur</a></li> </ul> </div></div> <div class=col-md-9 role=main> <h1 id=polymaps-une-alternative-a-openlayers>PolyMaps une alternative à OpenLayers<a class=headerlink href=#polymaps-une-alternative-a-openlayers title="Permanent link">#</a></h1> <p>:calendar: Date de publication initiale : 24 janvier 2011</p> <p><strong>Mots-clés :</strong> JavaScript | maps | PolyMaps</p> <p><img alt="logo polymaps" src=https://cdn.geotribu.fr/img/logos-icones/logiciels_librairies/polymaps.png></p> <p>Cela faisait longtemps que j'avais l'onglet du site de <a href=http://polymaps.org/ >PolyMaps</a> ouvert dans mon navigateur. Par manque de temps, je n'avais pas encore eu l'occasion d'explorer cette récente bibliothèque cartographique. Développant principalement sur l'API Google Maps et <a href=https://openlayers.org/ >OpenLayers</a>, j'avais envie de tester la capacité de cette bibliothèque et de juger si celle-ci pouvait à terme devenir une réelle alternative. </p> <p>Après avoir jeté un rapide coup d'œil aux différents exemples (ex <a href=http://polymaps.org/ex/ >PolyMaps</a>), passons concrètement à notre exploration.</p> <p>Développé en collaboration par <a href=http://simplegeo.com/ >SimpleGeo</a> et <a href=http://stamen.com/ >Stamen Design</a>, PolyMaps est une librairie cartographique développée en JavaScript. Le rendu des différents éléments utilise le format <a href=https://fr.wikipedia.org/wiki/Scalable_Vector_Graphics>SVG</a>.</p> <h2 id=telechargement>Téléchargement<a class=headerlink href=#telechargement title="Permanent link">#</a></h2> <p>Pour cela, se rendre sur la page <a href=http://polymaps.org/download.html>ah-hoc</a> et télécharger le zip de la dernière version - la 2.4 pour ce mois de janvier 2011.<br> Et décompresser cette archive quelque part sur votre serveur.</p> <p>unzip simplegeo-polymaps-v2.4.0-0-g42b145f.zip</p> <h2 id=initialisation>Initialisation<a class=headerlink href=#initialisation title="Permanent link">#</a></h2> <p>Si vous êtes un peu familier du développement sous <a href=http://www.openlayers.org/ >OpenLayers</a> ou <a href=http://code.google.com/intl/fr-FR/apis/maps/index.html>Google Maps</a>, vous n'allez pas être trop dépaysé. Et en plus si vous avez déjà tâté du <a href=http://jquery.com/ >jQuery</a>, vous ne serez pas surpris par le chaînage - c'est-à-dire le fait d'aligner les fonctions sur un même objet (puisqu'une fonction retourne toujours l'objet sur lequel elle a été appliquée). </p> <p>Attaquons directement en codant un petit exemple que nous allons détailler. Avec Polymaps, pas trop de surprise, il faut appeler l'API Javascript et construire notre carte : tout comme Google Maps ou OpenLayers.</p> <div class=highlight><pre><span></span><code><span class=p>@</span><span class=k>import</span> <span class=nt>url</span><span class=o>(</span><span class=s2>&quot;lib/js/examples/example.css&quot;</span><span class=o>)</span><span class=p>;</span>
<span class=nt>body</span> <span class=p>{</span> <span class=k>margin</span><span class=p>:</span> <span class=mi>0</span><span class=kt>px</span><span class=p>;</span> <span class=k>padding</span><span class=p>:</span> <span class=mi>0</span><span class=kt>px</span><span class=p>;</span> <span class=p>}</span>
<span class=p>#</span><span class=nn>map</span> <span class=p>{</span> <span class=k>width</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span> <span class=k>height</span><span class=p>:</span> <span class=mi>100</span><span class=kt>%</span><span class=p>;</span> <span class=p>}</span>  
</code></pre></div> <p>Je ne détaille pas le fichier de style example.css, mais celui-ci regroupe notamment les styles des boutons de zoom + et - . </p> <h2 id=javascript>JavaScript<a class=headerlink href=#javascript title="Permanent link">#</a></h2> <p>Maintenant le JavaScript - le fichier test1.js - de construction de la carte :</p> <div class=highlight><pre><span></span><code><span class=kd>var</span> <span class=nx>po</span> <span class=o>=</span> <span class=nx>org</span><span class=p>.</span><span class=nx>polymaps</span><span class=p>;</span>

<span class=kd>var</span> <span class=nx>map</span> <span class=o>=</span> <span class=nx>po</span><span class=p>.</span><span class=nx>map</span><span class=p>()</span>  
<span class=p>.</span><span class=nx>container</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;map&quot;</span><span class=p>).</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>po</span><span class=p>.</span><span class=nx>svg</span><span class=p>(</span><span class=s2>&quot;svg&quot;</span><span class=p>)))</span>  
<span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>po</span><span class=p>.</span><span class=nx>interact</span><span class=p>())</span>  
<span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>po</span><span class=p>.</span><span class=nx>hash</span><span class=p>());</span>

<span class=nx>map</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>po</span><span class=p>.</span><span class=nx>image</span><span class=p>()</span>  
<span class=p>.</span><span class=nx>url</span><span class=p>(</span><span class=nx>po</span><span class=p>.</span><span class=nx>url</span><span class=p>(</span><span class=s2>&quot;http://{S}tile.cloudmade.com&quot;</span>  
<span class=o>+</span> <span class=s2>&quot;/25e1c714473b482e9414c63afee96b22&quot;</span> <span class=c1>// ici mettre votre clé Cloudmade  </span>
<span class=o>+</span> <span class=s2>&quot;/998/256/{Z}/{X}/{Y}.png&quot;</span><span class=p>)</span>  
<span class=p>.</span><span class=nx>hosts</span><span class=p>([</span><span class=s2>&quot;a.&quot;</span><span class=p>,</span> <span class=s2>&quot;b.&quot;</span><span class=p>,</span> <span class=s2>&quot;c.&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>])));</span>

<span class=nx>map</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>po</span><span class=p>.</span><span class=nx>compass</span><span class=p>()</span>  
<span class=p>.</span><span class=nx>pan</span><span class=p>(</span><span class=s2>&quot;none&quot;</span><span class=p>));</span>  
</code></pre></div> <p>L'exemple ci-dessus affiche une carte glissante provenant de chez <a href=http://cloudmade.com/ >Cloudmade</a>. </p> <p>Tout d'abord l'initialisation :</p> <div class=highlight><pre><span></span><code><span class=kd>var</span> <span class=nx>po</span> <span class=o>=</span> <span class=nx>org</span><span class=p>.</span><span class=nx>polymaps</span><span class=p>;</span>  
</code></pre></div> <p>Il s'agit juste d'un raccourci pour éviter à avoir à re-saisir org.polymaps à chaque fois. Nous voyons qu'ici à la différence de Google Maps, Polymaps n'utilise pas le mot clé <em>new</em> pour construire les objets mais utilise une méthode <a href=https://fr.wikipedia.org/wiki/Fabrique_(patron_de_conception)>différente</a>. </p> <p>Ensuite la construction de la carte :</p> <div class=highlight><pre><span></span><code><span class=kd>var</span> <span class=nx>map</span> <span class=o>=</span> <span class=nx>po</span><span class=p>.</span><span class=nx>map</span><span class=p>()</span>  
<span class=p>.</span><span class=nx>container</span><span class=p>(</span><span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s2>&quot;map&quot;</span><span class=p>).</span><span class=nx>appendChild</span><span class=p>(</span><span class=nx>po</span><span class=p>.</span><span class=nx>svg</span><span class=p>(</span><span class=s2>&quot;svg&quot;</span><span class=p>)))</span>  
<span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>po</span><span class=p>.</span><span class=nx>interact</span><span class=p>());</span>  
</code></pre></div> <p>Nous voyons bien le chaînage mis en place :</p> <ul> <li><code>po.map</code> : constructeur ;</li> <li><code>container(...)</code> : ajout de la carte dans le conteneur défini dans le HTML, ce conteneur doit être un SVG, on ajoute donc la méthode appendChild(po.svg("svg")) qui est une méthode équivalente à celle-ci : document.createElementNS("<a href=http://www.w3.org/2000/svg>http://www.w3.org/2000/svg</a>") ;</li> <li><code>add(po.interact())</code> : ajout des contrôles de carte - déplacement, double-clic, zoom à la molette et 'pilotage' avec les flèches.</li> </ul> <p>Ajoutons ensuite une URL vers une carto jolie :</p> <div class=highlight><pre><span></span><code><span class=nx>map</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>po</span><span class=p>.</span><span class=nx>image</span><span class=p>()</span>  
<span class=p>.</span><span class=nx>url</span><span class=p>(</span><span class=nx>po</span><span class=p>.</span><span class=nx>url</span><span class=p>(</span><span class=s2>&quot;http://{S}tile.cloudmade.com&quot;</span>  
<span class=o>+</span> <span class=s2>&quot;/25e1c714473b482e9414c63afee96b22&quot;</span> <span class=c1>// ici votre clé Cloudmade  </span>
<span class=o>+</span> <span class=s2>&quot;/998/256/{Z}/{X}/{Y}.png&quot;</span><span class=p>)</span>  
<span class=p>.</span><span class=nx>hosts</span><span class=p>([</span><span class=s2>&quot;a.&quot;</span><span class=p>,</span> <span class=s2>&quot;b.&quot;</span><span class=p>,</span> <span class=s2>&quot;c.&quot;</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>])));</span>  
</code></pre></div> <p>Dans l'ordre :</p> <ul> <li><code>map.add(po.image()</code> : ajout d'une <em>couche</em> ;</li> <li><code>.url(po.url( ... )</code> : qui possède cette URL Cloudmade ;</li> <li><code>.hosts(["a.", "b.", "c.", ""])</code> : là aucune idée, si vous avez des pistes ...</li> </ul> <p>Et ensuite ajoutons le contrôle de zoom in et out :</p> <div class=highlight><pre><span></span><code><span class=nx>map</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=nx>po</span><span class=p>.</span><span class=nx>compass</span><span class=p>()</span>  
<span class=p>.</span><span class=nx>pan</span><span class=p>(</span><span class=s2>&quot;none&quot;</span><span class=p>));</span>  
</code></pre></div> <p>Centrons la carte sur Saint-Malo et choisissons un niveau de zoom :</p> <div class=highlight><pre><span></span><code><span class=nx>map</span><span class=p>.</span><span class=nx>center</span><span class=p>({</span><span class=nx>lat</span><span class=o>:</span> <span class=mf>48.6356</span><span class=p>,</span> <span class=nx>lon</span><span class=o>:</span> <span class=o>-</span><span class=mf>2.0448</span><span class=p>});</span>  
<span class=nx>map</span><span class=p>.</span><span class=nx>zoom</span><span class=p>(</span><span class=mf>12.0</span><span class=p>);</span>  
</code></pre></div> <p>Et ajoutons les copyright :wink: :</p> <div class=highlight><pre><span></span><code>© 2010  
[CloudMade](http://www.cloudmade.com/),  
[OpenStreetMap](https://www.openstreetmap.org/) contributors,  
[CCBYSA](http://creativecommons.org/licenses/by-sa/2.0/).  
</code></pre></div> <h2 id=premiere-conclusion>Première conclusion<a class=headerlink href=#premiere-conclusion title="Permanent link">#</a></h2> <p>Pour une entrée en matière, j'ai trouvé cette bibliothèque plutôt réussie - ça tourne parfaitement - et facile à utiliser : avec les quelques exemples en ligne, il est facile de commencer une première carte. Et ça permet de mettre un joli fond de carte provenant de CloudMade. Pour le moment, rien à dire, c'est bien fait. Evidemment, cette bibliothèque ne peut pas être comparée à OpenLayers - beaucoup plus complète.<br> Mais nous n'avons pas testé le SVG qui fait sa spécificité. Nous essaierons dans un prochain article de faire une carte choroplèthe.</p> <hr> <h2 id=auteur>Auteur<a class=headerlink href=#auteur title="Permanent link">#</a></h2> <p><img alt="Portait de GeoTribu" class=img-rdp-news-thumb src=https://cdn.geotribu.fr/img/internal/charte/geotribu_logo_64x64.png> <strong>GeoTribu</strong></p> <p>Toute l'actualité de la géomatique Open Source ! Mais aussi des tutoriels, des billets de blog, des tests et surtout une bonne humeur géographique !</p></div> </div> </div> <hr> <footer class=container> <center><span class=copyleft>&copy;</span> Geotribu</center> <center>Documentation built with <a href=http://www.mkdocs.org>MkDocs</a> and <a href=http://kristopolous.github.io/BOOTSTRA.386>BOOTSTRA.386</a>.</center> </footer> <script src=../../../../../../theme/assets/javascripts/extra.js></script> <script src=https://cdn.jsdelivr.net/npm/wa-mediabox@1.0.1/dist/wa-mediabox.min.js></script> <script src=https://unpkg.com/mermaid@8.6.4/dist/mermaid.min.js></script> <script src=../../../../../../search/main.js></script> </body> </html>