<!DOCTYPE html><html lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=description content="Site indépendant de veille sur la géomatique libre et open source. Articles, tutoriels et revues de presse (#GeoRDP) sur l'information géographique, les SIG, la cartographie, la représentation des données..."><meta name=author content=Geotribu><link href=https://static.geotribu.fr/articles/2014/art_2014-11-13/ rel=canonical><link rel="shortcut icon" href=../../../img/favicon.ico><title>Corriger automatiquement des géométries topologiquement invalides avec QGIS - Geotribu</title><link href=../../../css/bootstrap.min.css rel=stylesheet><link href=../../../css/font-awesome.min.css rel=stylesheet><link href=../../../css/bootstrap-theme.min.css rel=stylesheet><link href=../../../../../../theme/assets/stylesheets/extra.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/wa-mediabox@1.0.1/dist/wa-mediabox.min.css rel=stylesheet><!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.3/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]--><script src=../../../js/jquery-1.10.2.min.js></script><script src=../../../js/bootstrap.min.js></script><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'None', 'auto');
            ga('send', 'pageview');
        </script></head> <body> <div class="navbar navbar-default navbar-fixed-top" role=navigation> <div class=container> <div class=navbar-header> <button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-collapse> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href=../../..>Geotribu</a> </div> <div class="navbar-collapse collapse"> <ul class="nav navbar-nav"> <li> <a href=../../..>&#127968; Accueil</a> </li> <li class=dropdown> <a href=# class=dropdown-toggle data-toggle=dropdown>Revues de presse <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../..>2021</a> </li> <li> <a href=../../..>2020</a> </li> <li> <a href=../../..>2017</a> </li> <li> <a href=../../..>2016</a> </li> <li> <a href=../../..>2015</a> </li> <li> <a href=../../..>2014</a> </li> <li> <a href=../../..>2013</a> </li> <li> <a href=../../..>2012</a> </li> <li> <a href=../../..>2011</a> </li> <li> <a href=../../..>2010</a> </li> </ul> </li> <li class="dropdown active"> <a href=# class=dropdown-toggle data-toggle=dropdown>Articles <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../..>2021</a> </li> <li> <a href=../../..>2020</a> </li> <li> <a href=../../..>2015</a> </li> <li class=active> <a href=../../..>2014</a> </li> <li> <a href=../../..>2013</a> </li> <li> <a href=../../..>2012</a> </li> <li> <a href=../../..>2011</a> </li> <li> <a href=../../..>2010</a> </li> <li> <a href=../../..>2009</a> </li> <li> <a href=../../..>2008</a> </li> </ul> </li> <li class=dropdown> <a href=# class=dropdown-toggle data-toggle=dropdown>Contribuer <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../contribuer/introduction/ >Contribuer à Geotribu</a> </li> <li> <a href=../../../contribuer/requirements/ >Prérequis pour la contribution</a> </li> <li> <a href=../../../contribuer/contribution_guide/ >Guide de contribution</a> </li> <li> <a href=../../..>Editer le contenu</a> </li> <li> <a href=../../..>Générer le site web</a> </li> <li> <a href=../../..>Guides de rédaction</a> </li> <li> <a href=../../..>Archives</a> </li> </ul> </li> <li class=dropdown> <a href=# class=dropdown-toggle data-toggle=dropdown>A propos <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../team/ >L'équipe Geotribu</a> </li> <li> <a href=../../../team/acha/ >Aurélien Chaumet</a> </li> <li> <a href=../../../team/avdc/ >Arnaud Vandecasteele</a> </li> <li> <a href=../../../team/avha/ >Adrien Van Hamme</a> </li> <li> <a href=../../../team/edel/ >Etienne Delay</a> </li> <li> <a href=../../../team/fbor/ >Florian Boret</a> </li> <li> <a href=../../../team/fgob/ >Fabien Goblet</a> </li> <li> <a href=../../../team/gdbo/ >Guillaume de Boyer</a> </li> <li> <a href=../../../team/jmou/ >Julien Moura</a> </li> <li> <a href=../../../team/jory/ >Jérémie Ory</a> </li> <li> <a href=../../../team/jpie/ >Julie Pierson</a> </li> <li> <a href=../../../team/mraj/ >Mathieu Rajerison</a> </li> <li> <a href=../../../team/pver/ >Pierre Vernier</a> </li> <li> <a href=../../../team/rbov/ >Rémi Bovard</a> </li> <li> <a href=../../../team/rqui/ >Rodolphe Quiédeville</a> </li> <li> <a href=../../../team/tgra/ >Thomas Gratier</a> </li> <li> <a href=../../..>Archives</a> </li> </ul> </li> </ul> <ul class="nav navbar-nav navbar-right"> <li> <a href=../../2015/art_2015-01-11/ rel=next> <i class="fa fa-arrow-left"></i> Previous </a> </li> <li> <a href=../art_2014-09-25_dicogis/ rel=prev> Next <i class="fa fa-arrow-right"></i> </a> </li> <li> <a href=https://github.com/geotribu/website/ > geotribu/website </a> </li> </ul> </div> </div> </div> <div class=container> <div class=row> <div class=col-md-3><div class="bs-sidebar hidden-print affix well" role=complementary> <ul class="nav bs-sidenav"> <li class="main active"><a href=#corriger-automatiquement-des-geometries-topologiquement-invalides-avec-qgis>Corriger automatiquement des géométries topologiquement invalides avec QGIS</a></li> <li><a href=#logiciel-utilise>Logiciel utilisé</a></li> <li><a href=#demarche>Démarche</a></li> <li><a href=#conclusion>Conclusion</a></li> <li><a href=#auteur>Auteur</a></li> <li class="main "><a href=#arnaud-vandecasteele>Arnaud Vandecasteele</a></li> </ul> </div></div> <div class=col-md-9 role=main> <h1 id=corriger-automatiquement-des-geometries-topologiquement-invalides-avec-qgis>Corriger automatiquement des géométries topologiquement invalides avec QGIS<a class=headerlink href=#corriger-automatiquement-des-geometries-topologiquement-invalides-avec-qgis title="Permanent link">#</a></h1> <p>:calendar: Date de publication initiale : 13 novembre 2014</p> <p><strong>Mots-clés :</strong> GIS | QGIS</p> <p>Il arrive que, pour différentes raisons, vous receviez une couche de données qui est topologiquement invalide (polygones dont certains arcs se croisent, etc.). Avant d'entrer dans le vif du sujet et si le mot topologie ne vous est pas familier, je vous conseille la lecture de <a href=http://www.portailsig.org/content/grass-gis-geometries-topologies-et-consequences-pratiques-vecteurs-rasters-volumes>l'excellent article</a> de Martin laloux paru sur le Portail SIG.</p> <p>Bon revenons à nos moutons et à ma couche de données. Donc j'ai reçu des données prises depuis un GPS puis directement exportées au format Shapefiles. En raison de l'imprécision du GPS et du trajet effectué par la personne en charge de l'acquisition des données, la géométrie finale n'était pas toujours topologiquement valide. Ainsi, mes données s'affichaient correctement sur QGIS mais pour autant il m'était impossible de les analyser ou encore de les importer dans PostGIS. En effet, lors de l'import la librairie GEOS se plaignait à juste titre des nombreuses erreurs de topologie.</p> <p>Une approche aurait pu être de simplifier la géométrie des objets afin d'éliminer les erreurs potentielles. Bien que simple, cette démarche entraine également une modification initiale de la géométrie initiale de l'objet. De plus, même si cela élimine un grand nombre d'erreurs il en restait tout de même.</p> <p>De ce fait, je me suis tourné vers des outils dédiés me permettant de complètement corriger mes géométries. La démarche suivie est expliquée dans les paragraphes ci-dessous.</p> <hr> <h2 id=logiciel-utilise>Logiciel utilisé<a class=headerlink href=#logiciel-utilise title="Permanent link">#</a></h2> <p>Le logiciel SIG <a href=https://www.qgis.org>QGIS</a> ainsi que son plugin GRASS ont été utilisés pour corriger la topologie des objets. L’avantage d’utiliser GRASS est que contrairement à la plupart des logiciels SIG existants celui-ci s’appuie nativement sur une représentation topologique (arc, nœuds) des objets géographiques.</p> <p>Le plugin GRASS permet de bénéficier des nombreuses fonctionnalités du logiciel GRASS directement dans QGIS. Celui-ci est accessible depuis la boite à outils de QGIS. Si cette boite à outils n’est pas disponible, il suffit de l’activer à partir du menu : vue -&gt;panneaux -&gt; boite à outils.</p> <p>Cette boite à outils regroupe un ensemble de « géotraitements », mais seul le module vclean de Grass sera utilisé. Ce module dispose de différentes options dont deux qui seront utilisées pour notre démarche à savoir break et rmarea.</p> <p align=middle><img alt="QGIS Processing Toolbox GRASS vclean" loading=lazy src=https://cdn.geotribu.fr/img/tuto/qgis_fix_geometry/qgis_processing_toolbox_2-4.png title="QGIS Processing Toolbox GRASS vclean"></p> <h2 id=demarche>Démarche<a class=headerlink href=#demarche title="Permanent link">#</a></h2> <p>Comme précisé en introduction, la couche de données en entrée possède des entités dont la géométrie est invalide. L'outil de vérification de QGIS révèle d'ailleurs un grand nombre d'erreurs.</p> <p align=middle><img alt="QGIS GRASS vclean" loading=lazy src=https://cdn.geotribu.fr/img/tuto/qgis_fix_geometry/qgis_check_geom_validity_start.png title="QGIS GRASS vclean"></p> <p>La démarche proposée pour corriger ces erreurs s’appuie sur 4 principales étapes.</p> <h3 id=decoupage-des-intersections>Découpage des intersections<a class=headerlink href=#decoupage-des-intersections title="Permanent link">#</a></h3> <p>Tout d’abord en utilisant l’option <code>break</code> la géométrie initiale de l’objet est découpée lorsqu’une intersection est détectée. Le seuil (<em>threshold</em>) peut varier en fonction de vos données. Quelques tests doivent être effectués afin d’obtenir le plus approprié. Dans notre cas, un seuil à 10 était celui donnant les meilleurs résultats. </p> <p align=middle><img alt="vclean - Formulaire break" loading=lazy src=https://cdn.geotribu.fr/img/tuto/qgis_fix_geometry/qgis_geom_step_break_form.png title="vclean - Formulaire break"></p> <p>À la fin de processus, les polygones ayant des intersections sont alors découpés en deux. </p> <p align=middle><img alt="vclean - Résultat break" loading=lazy src=https://cdn.geotribu.fr/img/tuto/qgis_fix_geometry/qgis_geom_step_break_result.png title="vclean - Résultat break"></p> <h3 id=suppression-des-reliquats>Suppression des reliquats<a class=headerlink href=#suppression-des-reliquats title="Permanent link">#</a></h3> <p>Une fois, le découpage des intersections réalisé, il faut maintenant supprimer les reliquats de géométrie. Pour cela l’option <code>rmarea</code> est utilisée. Celle-ci supprime les géométries dont l’aire est inférieure à un seuil défini. Comme précédemment, ce seuil peut varier est doit être adapté en fonction des données initiales. </p> <p align=middle><img alt="vclean - Résultat rmarea break" loading=lazy src=https://cdn.geotribu.fr/img/tuto/qgis_fix_geometry/qgis_geom_step_rmarea_result.png title="vclean - Résultat rmarea break"></p> <p>Une ultime vérification me confirme que ma couche est dorénavant topologiquement valide.</p> <p align=middle><img alt="vclean - Vérification des géométries" loading=lazy src=https://cdn.geotribu.fr/img/tuto/qgis_fix_geometry/qgis_check_geom_validity_end.png title="vclean - Vérification des géométries"></p> <p>Et voilà, j'ai maintenant ma couche qui est géométriquement valide. Je peux alors l'importer dans PostGIS ou effectuer les traitements que je souhaite.</p> <hr> <h2 id=conclusion>Conclusion<a class=headerlink href=#conclusion title="Permanent link">#</a></h2> <p>La démarche proposée est essentiellement manuelle. Bien évidemment rien ne vous empêche d'utiliser le model builder de QGIS pour automatiser tout cela ! A vous de jouer.</p> <hr> <h2 id=auteur>Auteur<a class=headerlink href=#auteur title="Permanent link">#</a></h2> <h1 id=arnaud-vandecasteele>Arnaud Vandecasteele<a class=headerlink href=#arnaud-vandecasteele title="Permanent link">#</a></h1> <p><img alt=portrait class=img-rdp-news-thumb src=https://cdn.geotribu.fr/img/internal/contributeurs/avdc.jpg title=portrait></p> <p>Bien qu'issus à l'origine d'un parcours universitaire (doctorat et post-doc), j'ai finalement tenté l'aventure entrepreunariale au travers de <a href=http://geolab.re/ >Geolab</a>. Mes principaux centres d'intêrets dans le domaine de la géomatique portent sur les logiciels Open Source et plus particulièrement QGIS. J'aime également le développement informatique avec une forte préférence à tout ce qui se passe côté serveur (base de données, traitements, etc.). Côté techno, mes choix se portent habituellement sur du (Geo)Django et PostgreSQL/PostGIS.</p> <p>Pendant mon temps libre, vous me trouverez un GPS à la main afin de contribuer à <a href=https://www.openstreetmap.org/ >OpenStreetMap</a> ou sur un tatami en train de pratiquer le <a href=https://fr.wikipedia.org/wiki/Jiu-jitsu_br%C3%A9silien>Jiu-Jitsu Brésilien</a>.</p> <p>Si vous êtes intéressés par l'un ou tous ces sujets, n'hésitez pas à me contacter !</p></div> </div> </div> <hr> <footer class=container> <center><span class=copyleft>&copy;</span> Geotribu</center> <center>Documentation built with <a href=http://www.mkdocs.org>MkDocs</a> and <a href=http://kristopolous.github.io/BOOTSTRA.386>BOOTSTRA.386</a>.</center> </footer> <script src=../../../../../../theme/assets/javascripts/extra.js></script> <script src=https://cdn.jsdelivr.net/npm/wa-mediabox@1.0.1/dist/wa-mediabox.min.js></script> <script src=https://unpkg.com/mermaid@8.6.4/dist/mermaid.min.js></script> <script src=../../../../../../search/main.js></script> </body> </html>