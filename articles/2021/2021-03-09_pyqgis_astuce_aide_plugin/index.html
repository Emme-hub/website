<!DOCTYPE html><html lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=description content="Site indépendant de veille sur la géomatique libre et open source. Articles, tutoriels et revues de presse (#GeoRDP) sur l'information géographique, les SIG, la cartographie, la représentation des données..."><meta name=author content=Geotribu><link href=https://static.geotribu.fr/articles/2021/2021-03-09_pyqgis_astuce_aide_plugin/ rel=canonical><link rel="shortcut icon" href=../../../img/favicon.ico><title>Afficher facilement l'aide de son plugin QGIS - Geotribu</title><link href=../../../css/bootstrap.min.css rel=stylesheet><link href=../../../css/font-awesome.min.css rel=stylesheet><link href=../../../css/bootstrap-theme.min.css rel=stylesheet><link href=../../../../../../theme/assets/stylesheets/extra.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/wa-mediabox@1.0.1/dist/wa-mediabox.min.css rel=stylesheet><!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.3/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]--><script src=../../../js/jquery-1.10.2.min.js></script><script src=../../../js/bootstrap.min.js></script><script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'None', 'auto');
            ga('send', 'pageview');
        </script></head> <body> <div class="navbar navbar-default navbar-fixed-top" role=navigation> <div class=container> <div class=navbar-header> <button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-collapse> <span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span> </button> <a class=navbar-brand href=../../..>Geotribu</a> </div> <div class="navbar-collapse collapse"> <ul class="nav navbar-nav"> <li> <a href=../../..>&#127968; Accueil</a> </li> <li class=dropdown> <a href=# class=dropdown-toggle data-toggle=dropdown>Revues de presse <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../..>2021</a> </li> <li> <a href=../../..>2020</a> </li> <li> <a href=../../..>2017</a> </li> <li> <a href=../../..>2016</a> </li> <li> <a href=../../..>2015</a> </li> <li> <a href=../../..>2014</a> </li> <li> <a href=../../..>2013</a> </li> <li> <a href=../../..>2012</a> </li> <li> <a href=../../..>2011</a> </li> <li> <a href=../../..>2010</a> </li> </ul> </li> <li class="dropdown active"> <a href=# class=dropdown-toggle data-toggle=dropdown>Articles <b class=caret></b></a> <ul class=dropdown-menu> <li class=active> <a href=../../..>2021</a> </li> <li> <a href=../../..>2020</a> </li> <li> <a href=../../..>2015</a> </li> <li> <a href=../../..>2014</a> </li> <li> <a href=../../..>2013</a> </li> <li> <a href=../../..>2012</a> </li> <li> <a href=../../..>2011</a> </li> <li> <a href=../../..>2010</a> </li> <li> <a href=../../..>2009</a> </li> <li> <a href=../../..>2008</a> </li> </ul> </li> <li class=dropdown> <a href=# class=dropdown-toggle data-toggle=dropdown>Contribuer <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../contribuer/introduction/ >Contribuer à Geotribu</a> </li> <li> <a href=../../../contribuer/requirements/ >Prérequis pour la contribution</a> </li> <li> <a href=../../../contribuer/contribution_guide/ >Guide de contribution</a> </li> <li> <a href=../../..>Editer le contenu</a> </li> <li> <a href=../../..>Générer le site web</a> </li> <li> <a href=../../..>Guides de rédaction</a> </li> <li> <a href=../../..>Archives</a> </li> </ul> </li> <li class=dropdown> <a href=# class=dropdown-toggle data-toggle=dropdown>A propos <b class=caret></b></a> <ul class=dropdown-menu> <li> <a href=../../../team/ >L'équipe Geotribu</a> </li> <li> <a href=../../../team/acha/ >Aurélien Chaumet</a> </li> <li> <a href=../../../team/avdc/ >Arnaud Vandecasteele</a> </li> <li> <a href=../../../team/avha/ >Adrien Van Hamme</a> </li> <li> <a href=../../../team/edel/ >Etienne Delay</a> </li> <li> <a href=../../../team/fbor/ >Florian Boret</a> </li> <li> <a href=../../../team/fgob/ >Fabien Goblet</a> </li> <li> <a href=../../../team/gdbo/ >Guillaume de Boyer</a> </li> <li> <a href=../../../team/jmou/ >Julien Moura</a> </li> <li> <a href=../../../team/jory/ >Jérémie Ory</a> </li> <li> <a href=../../../team/jpie/ >Julie Pierson</a> </li> <li> <a href=../../../team/mraj/ >Mathieu Rajerison</a> </li> <li> <a href=../../../team/pver/ >Pierre Vernier</a> </li> <li> <a href=../../../team/rbov/ >Rémi Bovard</a> </li> <li> <a href=../../../team/rqui/ >Rodolphe Quiédeville</a> </li> <li> <a href=../../../team/tgra/ >Thomas Gratier</a> </li> <li> <a href=../../..>Archives</a> </li> </ul> </li> </ul> <ul class="nav navbar-nav navbar-right"> <li> <a href=../2021-04-01_qtribu_plugin_qgis_geotribu/ rel=next> <i class="fa fa-arrow-left"></i> Previous </a> </li> <li> <a href=../2021-03-05_reclus_confins_replay_geotribu/ rel=prev> Next <i class="fa fa-arrow-right"></i> </a> </li> <li> <a href=https://github.com/geotribu/website/ > geotribu/website </a> </li> </ul> </div> </div> </div> <div class=container> <div class=row> <div class=col-md-3><div class="bs-sidebar hidden-print affix well" role=complementary> <ul class="nav bs-sidenav"> <li class="main active"><a href=#plugin-qgis-rediriger-facilement-vers-laide-en-ligne>Plugin QGIS : rediriger facilement vers l'aide en ligne</a></li> <li><a href=#introduction>Introduction</a></li> <li><a href=#creer-la-redirection-301>Créer la redirection 301</a></li> <li><a href=#appeler-la-page-depuis-le-plugin>Appeler la page depuis le plugin</a></li> <li><a href=#conclusion>Conclusion</a></li> <li><a href=#auteur>Auteur</a></li> <li class="main "><a href=#julien-moura>Julien Moura</a></li> </ul> </div></div> <div class=col-md-9 role=main> <h1 id=plugin-qgis-rediriger-facilement-vers-laide-en-ligne>Plugin QGIS : rediriger facilement vers l'aide en ligne<a class=headerlink href=#plugin-qgis-rediriger-facilement-vers-laide-en-ligne title="Permanent link">#</a></h1> <p>:calendar: Date de publication initiale : 09 mars 2021</p> <p><strong>Mots-clés :</strong> QGIS | PyQGIS | développement | plugin | documentation</p> <p>Pré-requis :</p> <ul> <li>des notions en PyQGIS (Python + Qt + API QGIS)</li> </ul> <h2 id=introduction>Introduction<a class=headerlink href=#introduction title="Permanent link">#</a></h2> <p><img alt="icône PyQT" class=img-rdp-news-thumb src=https://cdn.geotribu.fr/img/logos-icones/programmation/python_and_qt.svg title="Python + Qt = PyQt"></p> <p>Plutôt que de stocker toute la documentation au format HTML et les fichiers associés (CSS, JS, images...) dans le plugin QGIS qui est téléchargé par vos millions d'utilisateur/ices, je vous propose une méthode plus simple que j'ai utilisée dans différents plugins comme <a href=https://plugins.qgis.org/plugins/gml_application_schema_toolbox/ >GMLAS Toolbox</a>, <a href=https://plugins.qgis.org/plugins/menu_from_project/ >Menu Layers from Project</a> ou <a href=https://plugins.qgis.org/plugins/LandSurveyCodesImport/ >Land Survey Codes Import</a>.</p> <p>Si vous n'avez pas d'aide en ligne, de documentation, de wiki sur le dépôt GitHub ou GitLab ou même de README, alors je ne peux rien pour vous et il est temps d'aller consulter un autre article du site :wink:.</p> <p align=middle><img alt="Documentation Le Chat" loading=lazy src=https://cdn.geotribu.fr/img/tuto/qgis_plugin_show_help/documentation_le-chat.jpg title="Documentation Le Chat"></p> <p>Pour la suite de ce tutoriel, considérons que l'aide en ligne de notre plugin est disponibe en français et en anglais, dont les adresses URLs seraient :</p> <ul> <li> <p>:fr: la fiche métier "M1808 Information Géographique" du registre ROME<sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup> :</p> <div class=highlight><pre><span></span><code>https://candidat.pole-emploi.fr/marche-du-travail/fichemetierrome?codeRome=M1808
</code></pre></div> </li> <li> <p>:gb: la fiche Wikipédia <em>GIS</em> :</p> <div class=highlight><pre><span></span><code>https://en.wikipedia.org/wiki/Geographic_information_system
</code></pre></div> </li> </ul> <h2 id=creer-la-redirection-301>Créer la redirection 301<a class=headerlink href=#creer-la-redirection-301 title="Permanent link">#</a></h2> <p><img alt="icône HTML5" class=img-rdp-news-thumb src=https://cdn.geotribu.fr/img/logos-icones/programmation/html5.png title="icône HTML5"></p> <p>Le multilinguisme est géré en utilisant le code de langue (<em>locale</em>), renvoyé par l'application Qt (en l'occurrencee QGIS) comme suffixe. Par exemple : <code>index-fr.html</code> sera ouvert en priorité si QGIS est défini en français. En dernier recours, si présent, c'est le fichier sans suffixe qui est ouvert <code>index.html</code>.</p> <p>A l'intérieur de l'arborescence de notre plugin, on crée donc un fichier <code>docs/index-fr.html</code> dans lequel on écrit simplement une <a href=https://developer.mozilla.org/fr/docs/Web/HTTP/Status/301>redirection HTTP</a> :</p> <div class=highlight><pre><span></span><code><span class=cp>&lt;!doctype html&gt;</span>
<span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&quot;fr&quot;</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&quot;utf-8&quot;</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>Redirection en cours...<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span><span class=kd>var</span> <span class=nx>anchor</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>hash</span><span class=p>.</span><span class=nx>substr</span><span class=p>(</span><span class=mf>1</span><span class=p>);</span> <span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s2>&quot;https://candidat.pole-emploi.fr/marche-du-travail/fichemetierrome?codeRome=M1808/&quot;</span><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>

    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Redirection vers la documentation en ligne...<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>

<span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>

<span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</code></pre></div> <p>Et un fichier <code>doc/index-en.html</code> :</p> <div class=highlight><pre><span></span><code><span class=cp>&lt;!doctype html&gt;</span>
<span class=p>&lt;</span><span class=nt>html</span> <span class=na>lang</span><span class=o>=</span><span class=s>&quot;fr&quot;</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&quot;utf-8&quot;</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>Redirecting...<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span><span class=kd>var</span> <span class=nx>anchor</span> <span class=o>=</span> <span class=nb>window</span><span class=p>.</span><span class=nx>location</span><span class=p>.</span><span class=nx>hash</span><span class=p>.</span><span class=nx>substr</span><span class=p>(</span><span class=mf>1</span><span class=p>);</span> <span class=nx>location</span><span class=p>.</span><span class=nx>href</span> <span class=o>=</span> <span class=s2>&quot;https://en.wikipedia.org/wiki/Geographic_information_system/&quot;</span><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
<span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>

<span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>

    <span class=p>&lt;</span><span class=nt>p</span><span class=p>&gt;</span>Redirection to the online documentation...<span class=p>&lt;/</span><span class=nt>p</span><span class=p>&gt;</span>

<span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>

<span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</code></pre></div> <hr> <h2 id=appeler-la-page-depuis-le-plugin>Appeler la page depuis le plugin<a class=headerlink href=#appeler-la-page-depuis-le-plugin title="Permanent link">#</a></h2> <p><img alt="icône Edit Help Content - QGIS" class=img-rdp-news-thumb src=https://raw.githubusercontent.com/qgis/QGIS/master/images/themes/default/mActionEditHelpContent.svg title="icône Edit Help Content - QGIS"></p> <p>Une fois que tout cela est en place, il reste à brancher notre menu d'aide sur cette redirection. Pour cela, on utilise <a href=https://github.com/qgis/QGIS/blob/ltr-3_16/python/utils.py#L502-L530>la fonction showPluginHelp</a>.</p> <p>Quelque part dans les imports :</p> <div class=highlight><pre><span></span><code><span class=c1># imports</span>
<span class=kn>from</span> <span class=nn>qgis.core</span> <span class=kn>import</span> <span class=n>QgsApplication</span>
<span class=kn>from</span> <span class=nn>qgis.PyQt.QtGui</span> <span class=kn>import</span> <span class=n>QIcon</span>
<span class=hll><span class=kn>from</span> <span class=nn>qgis.utils</span> <span class=kn>import</span> <span class=n>showPluginHelp</span>
</span></code></pre></div> <p>Quelque part dans la définition du <a href=/articles/2021/2021-01-19_pyqgis_utiliser_icones_integrees/#recycler-les-icones-de-linterface-de-qgis>menu défini dans un précédent tuto</a> :</p> <div class=highlight><pre><span></span><code><span class=p>[</span><span class=o>...</span><span class=p>]</span>

<span class=k>class</span> <span class=nc>PluginGeotribu</span><span class=p>:</span>

    <span class=p>[</span><span class=o>...</span><span class=p>]</span>

    <span class=c1># quelque part dans la fonction de définition du menu de notre plugin</span>
    <span class=k>def</span> <span class=nf>initGui</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>

        <span class=p>[</span><span class=o>...</span><span class=p>]</span>

        <span class=c1># ici on définit notre bouton de menu</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>action_menu_help</span> <span class=o>=</span> <span class=n>QAction</span><span class=p>(</span>
            <span class=n>QIcon</span><span class=p>(</span><span class=n>QgsApplication</span><span class=o>.</span><span class=n>iconPath</span><span class=p>(</span><span class=s2>&quot;mActionHelpContents.svg&quot;</span><span class=p>)),</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>tr</span><span class=p>(</span><span class=s2>&quot;Help&quot;</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span><span class=p>,</span>
            <span class=bp>self</span><span class=o>.</span><span class=n>iface</span><span class=o>.</span><span class=n>mainWindow</span><span class=p>(),</span>
        <span class=p>)</span>

        <span class=c1># on ajoute le bouton au menu de notre plugin</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>iface</span><span class=o>.</span><span class=n>addPluginToMenu</span><span class=p>(</span><span class=s2>&quot;Le nom du plugin&quot;</span><span class=p>,</span> <span class=bp>self</span><span class=o>.</span><span class=n>action_menu_help</span><span class=p>)</span>

        <span class=c1># on connecte notre bouton à la fonction d&#39;ouverture de l&#39;aide</span>
<span class=hll>        <span class=bp>self</span><span class=o>.</span><span class=n>action_menu_help</span><span class=o>.</span><span class=n>triggered</span><span class=o>.</span><span class=n>connect</span><span class=p>(</span>
</span><span class=hll>                <span class=k>lambda</span><span class=p>:</span> <span class=n>showPluginHelp</span><span class=p>(</span><span class=n>filename</span><span class=o>=</span><span class=s2>&quot;doc/index&quot;</span><span class=p>)</span>
</span><span class=hll>            <span class=p>)</span>
</span></code></pre></div> <p>Au clic sur le menu, QGIS ouvre le fichier <code>index-fr.html</code> (si son interface est en français ou <code>index-en.html</code> si elle est en anglais dans le navigateur par défaut du système, qui va rediriger vers votre documentation en ligne :sparkler:.</p> <hr> <h2 id=conclusion>Conclusion<a class=headerlink href=#conclusion title="Permanent link">#</a></h2> <p>Ce que j'aime bien dans cette façon de faire c'est que ça tient en un seul fichier HTML et 2 lignes de Python.<br> C'est pas cher payé pour orienter facilement vos utilisateur/ices vers la documentation que vous avez mis tant de soin à rédiger (et qu'ils/elles prendront bien soin de survoler) !</p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>A noter que la fonction <code>showPluginHelp</code> est aussi valable si la documentation est stockée dans le plugin.</p> </div> <hr> <h2 id=auteur>Auteur<a class=headerlink href=#auteur title="Permanent link">#</a></h2> <h1 id=julien-moura>Julien Moura<a class=headerlink href=#julien-moura title="Permanent link">#</a></h1> <p><img alt="Portrait Julien Moura" class=img-rdp-news-thumb src=https://cdn.geotribu.fr/img/internal/contributeurs/jmou.jfif title="Portrait Julien Moura"></p> <p>Géographe "sigiste" de formation, j'ai d'abord travaillé sur différentes thématiques et types de structures : la gestion des déchets en milieu urbain à Madagascar, le foncier d'intérêt général auprès de <a href=http://www.epf-reunion.com/ >l'EPF de La Réunion</a>, l'organisation et la résilience urbaine face aux risques naturels à Lima pour l'IRD.</p> <p>C'est en m'intéressant à la gouvernance et à l'ouverture des données géographiques que je travaille à <a href=https://www.isogeo.com>Isogeo</a> quelques années. L'occasion d'asseoir mes compétences en développement et gestion de produit informatique. En 2020, je deviens indépendant (In Geo Veritas) puis rejoins les rangs d'<a href=https://oslandia.com/ >Oslandia</a>.</p> <p>Féru des dynamiques de contributions, je participe activement à Geotribu depuis fin 2011 et, comme ça me manquait trop, j'ai décidé de lancer sa renaissance en 2020.</p> <div class=footnote> <hr> <ol> <li id=fn:1> <p><a href=https://fr.wikipedia.org/wiki/R%C3%A9pertoire_op%C3%A9rationnel_des_m%C3%A9tiers_et_des_emplois><strong>R</strong>épertoire <strong>O</strong>pérationnel des <strong>M</strong>étiers et des <strong>E</strong>mplois</a>. En savoir plus sur l'historique de création de cette fiche pour le domaine de la géomatique, voir <a href=https://georezo.net/wiki/main:formetiers:dem_metiers/ >la démarche métier sur GeoRezo</a>.&#160;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> </ol> </div></div> </div> </div> <hr> <footer class=container> <center><span class=copyleft>&copy;</span> Geotribu</center> <center>Documentation built with <a href=http://www.mkdocs.org>MkDocs</a> and <a href=http://kristopolous.github.io/BOOTSTRA.386>BOOTSTRA.386</a>.</center> </footer> <script src=../../../../../../theme/assets/javascripts/extra.js></script> <script src=https://cdn.jsdelivr.net/npm/wa-mediabox@1.0.1/dist/wa-mediabox.min.js></script> <script src=https://unpkg.com/mermaid@8.6.4/dist/mermaid.min.js></script> <script src=../../../../../../search/main.js></script> </body> </html>